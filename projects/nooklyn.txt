

locations sometimes don't show on listing detail page
go through legal docs

API
  prod (agent_id: 15842)
    curl -d 'session[email]=gallo.j@gmail.com&session[password]=********' 'https://nooklyn.com/api/v1/sessions'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/listings'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/locations?filter[neighborhood-id]=35&filter[location-category-id]=3&include=location-category'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/location-categories'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/favorites?agent-id=15842'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/ignored-listings'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/mates?include=neighborhood,agent'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/mate-favorites?agent-id=15842'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/mate-ignores'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/agents/15842/mate-posts'
    curl 'https://nooklyn.com/locations.json?latitude=40.7100288&longitude=-73.9470297&radius=1'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/location-favorites?agent-id=15842'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/conversations?include=participating-agents,messages'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/conversation-messages'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/hearts?listing-id=3456'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/agents/15842/mate-posts'
    curl -X DELETE -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'https://nooklyn.com/api/v1/hearts/3456'

  local (agent_id: 15842)
    curl -d 'session[email]=gallo.j@gmail.com&session[password]=********' 'http://localhost:3000/api/v1/sessions'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/listings'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/locations?filter[neighborhood-id]=35&filter[location-category-id]=3&include=location-category'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/location-categories'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/favorites?agent-id=15842'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/ignored-listings'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/mates?include=neighborhood,agent'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/mate-favorites?agent-id=15842'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/mate-ignores'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/agents/15842/mate-posts'
    curl 'http://localhost:3000/locations.json?latitude=40.7100288&longitude=-73.9470297&radius=1'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/location-favorites?agent-id=15842'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/conversations?include=participating-agents,messages'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/conversation-messages'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/hearts?listing-id=3456'
    curl -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/agents/15842/mate-posts'
    curl -X DELETE -H 'API-TOKEN: 3a197ffc2f9e4bdca6f9249fbe6af222' 'http://localhost:3000/api/v1/hearts/3456'

// TODO: remove
let realm = try! Realm()
try! realm.write {
    realm.delete(realm.objects(Neighborhood))
    realm.delete(realm.objects(LocationCategory))
    realm.delete(realm.objects(Location).filter("id != '74'"))
}

# get all conversations with no messages
select
  id
from
  conversations
where id not in (
  select conversation_id
  from conversation_messages
);
delete from conversations where id not in (
  select conversation_id
  from conversation_messages
);

# get all malformatted/empty subway lines
select
  id,
  subway_line
from
  listings
where
  status = 'Available'
  and (
    length(subway_line) = 0
    or subway_line ~ '  '
    or (length(subway_line) > 1 and subway_line !~ ' ')
    or subway_line ~ '([^[:alnum:]\s])'
  )
order by
  subway_line,
  id;

# get all locations with malformatted address
select id, name, address_line_one, state from locations where address_line_one ~ '(Avenue|Street|\.$)' or state ~ '(New York|California)' or address_line_one ~ city;

# get all locations with a slug containing a period
select id, slug from locations where slug like '%.%' order by id;

select l.id, l.name, lc.name from locations l join location_categories lc on (lc.id = l.location_category_id) where l.name = 'Enid''s';

# S3
development:
  bucket: nooklyn-dev
  access_key_id: AKIAI6SP3RIVOVM7MA4A
  secret_access_key: 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
test:
  bucket: nooklyn-test
  access_key_id: AKIAI6SP3RIVOVM7MA4A
  secret_access_key: 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
production:
  bucket: nooklyn-pro
  access_key_id: AKIAJGPHHWBPQKACQB4A
  secret_access_key: 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

# saving realm db to test
find '/Users/joegallo/Library/Developer/CoreSimulator/Devices/7145F404-DAA8-4758-B408-A724850F3B79/data/Containers/Data/Application/' -type f -name 'default.realm'

cp /Users/joegallo/Library/Developer/CoreSimulator/Devices/7145F404-DAA8-4758-B408-A724850F3B79/data/Containers/Data/Application/D401E697-F5B4-4C2D-AA18-4DE6C2CB7464/Documents/default.realm ~/Downloads

cp ~/Downloads/default.realm /Users/joegallo/Library/Developer/CoreSimulator/Devices/7145F404-DAA8-4758-B408-A724850F3B79/data/Containers/Data/Application/D401E697-F5B4-4C2D-AA18-4DE6C2CB7464/Documents/default.realm

sudo cp /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift/iphonesimulator/libswiftSecurity.dylib /Applications/Xcode-beta.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift/iphonesimulator/libswiftSecurity.dylib

# push notifications
apn push "<79f083d0 7db6d40a f5d7ed4a 035b7392 022ef8ed 53d04b53 e998851b eddaea65>" -c ~/Downloads/dev.pem -m "Hello from the command line" -b 1 -s sosumi.aiff
apn push "<bba0ae50 65d65cff ebd32f50 ceafcceb 497153a2 72f663d9 b31dba19 9f48161a>" -c ./config/apns/nooklyn_apple_push_notification_dev.pem -m "Test" -b 1 -s sosumi.aiff
